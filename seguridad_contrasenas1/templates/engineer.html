{% extends "base.html" %}
{% block content %}
<div class="card shadow-sm p-3">
  <h3>Panel Ingeniero</h3>

  <div class="row">
    <div class="col-md-6">
      <h5 class="mt-3">Añadir Usuario</h5>
      <form method="POST" class="mb-3">
        <input type="hidden" name="action" value="add_user">
        <div class="mb-2"><input name="nombre" class="form-control" placeholder="Nombre" required></div>
        <div class="mb-2"><input name="email" type="email" class="form-control" placeholder="Email" required></div>
        <div class="mb-2"><input name="password" type="password" class="form-control" placeholder="Contraseña" required></div>
        <button class="btn btn-success btn-sm">Añadir Usuario</button>
      </form>

      <h5 class="mt-3">Añadir Administrador</h5>
      <form method="POST" class="mb-3">
        <input type="hidden" name="action" value="add_admin">
        <div class="mb-2"><input name="nombre" class="form-control" placeholder="Nombre" required></div>
        <div class="mb-2"><input name="email" type="email" class="form-control" placeholder="Email" required></div>
        <div class="mb-2"><input name="password" type="password" class="form-control" placeholder="Contraseña" required></div>
        <button class="btn btn-warning btn-sm">Añadir Admin</button>
      </form>

      <h5 class="mt-3">Usuarios</h5>
      <table class="table table-sm">
        <thead><tr><th>Nombre</th><th>Email</th><th>Rol</th><th>2FA</th><th>Eliminar</th></tr></thead>
        <tbody>
          {% for u in users %}
          <tr>
            <td>{{ u[1] }}</td><td>{{ u[2] }}</td><td>{{ u[3] }}</td><td>{{ 'Sí' if u[4] else 'No' }}</td>
            <td>
              <form method="POST" onsubmit="return confirm('Eliminar usuario?')">
                <input type="hidden" name="action" value="delete">
                <input type="hidden" name="user_id" value="{{ u[0] }}">
                <button class="btn btn-danger btn-sm">Eliminar</button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="col-md-6">
      <h5 class="mt-3">APIs Configuradas</h5>
      <form method="POST" class="mb-3">
        <input type="hidden" name="action" value="add_api">
        <div class="mb-2"><input type="text" name="nombre_api" class="form-control" placeholder="Nombre API (e.g., Facebook)" required></div>
        <button class="btn btn-primary btn-sm">Simular Conexión y Añadir</button>
      </form>

      <table class="table table-sm">
        <thead><tr><th>Nombre</th><th>Estado</th><th>Fecha</th></tr></thead>
        <tbody>
          {% for a in apis %}
          <tr><td>{{ a[1] }}</td><td>{{ a[2] }}</td><td>{{ a[3] }}</td></tr>
          {% endfor %}
          {% if apis|length == 0 %}
          <tr><td colspan="3">No hay APIs configuradas.</td></tr>
          {% endif %}
        </tbody>
      </table>
    </div>
  </div>

  <a href="{{ url_for('admin_panel') }}" class="btn btn-link mt-3">Ir a Panel Admin</a>
</div>
{% endblock %}
